# Query para obtener listado de logs relacionados al pago
select.traedatos.log=db1; \
SELECT  G_CONTRACT_ID, GF_MOV_DATE, GF_SEQUENCE_ID, GF_OPERATION_PAGE_ID, \
		GF_ACCT_MOV_ID, G_MICROCREDIT_MOVEMENT_TYPE, GF_MOVEMENT_AMOUNT, \
		G_CURRENCY_ID, G_ACTIVE_MOVEMENT_IND_TYPE, GF_GL_ACCOUNT_DATE, \
		GF_INSTALLMENT_PERIOD_DATE, GF_GL_ACCOUNTING_STRING_ID, G_LOCAL_CONTRACT_TYPE, \
		GF_MOV_ASSO_ACCOUNT_ID, GF_TRACKING_TRANSACTION_DESC, GF_ACCOUNTING_POSITION_ID, \
		GF_NEW_CUST_REGIONAL_CENTRE_ID, GF_APP_CHANNEL_ID, GF_CUSTOMER_PROPOSAL_BRANCH_ID, \
		GF_CREDIT_REQUEST_ORIGIN_RC_ID, GF_USER_AUDIT_ID, GF_AUDIT_DATE \
FROM    T_KMIC_MCRCR_LOG_MOVEMENT \
WHERE   G_MICROCREDIT_MOVEMENT_TYPE NOT IN('PGAUTCON') \
AND     GF_ACCT_MOV_ID = (  SELECT  GF_ACCT_MOV_ID \
                            FROM    T_KMIC_MCRCR_LOG_MOVEMENT \
                            WHERE   G_CONTRACT_ID = :contractId \
                            AND     GF_OPERATION_PAGE_ID = :microloanId \
                            AND     GF_INSTALLMENT_PERIOD_DATE = :date \
                            GROUP BY GF_ACCT_MOV_ID);

#Querys para actualziar montos y dar reverso, ojo faltan las columnas
update.microcredit.contract=db1; \
UPDATE KMIC.t_kmic_microcredit_contract SET  \
GF_CONTRACT_DATE = :date, \
GF_GRANTED_AMOUNT = :amount, \
G_MCRCR_CONTRACT_STATUS_TYPE = :eventCode \
WHERE G_CONTRACT_ID = :contractId;


update.amortization.condition=db1;\
UPDATE KMIC.t_kmic_amortization_condition SET \
GF_ITEM_SETTLEMENT_DATE = :date, \
GF_APPLIED_ECON_COND_AMOUNT = :amount, \
G_MCRCR_AMORT_STATUS_TYPE = :eventCode \
WHERE G_CONTRACT_ID = :contractId AND GF_OPERATION_PAGE_ID = :microloanId


update.mcecr.amortization=db1; \
UPDATE KMIC.t_kmic_mcrcr_dspn_amort SET \
GF_ITEM_SETTLEMENT_DATE = :date, \
GF_CAP_AMORTIZ_INSTLMNT_AMOUNT = :amount, \
G_MCRCR_AMORT_STATUS_TYPE = :eventCode \
WHERE G_CONTRACT_ID = :contractId \
AND GF_OPERATION_PAGE_ID = :microloanId;